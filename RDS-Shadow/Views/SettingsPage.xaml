<Page
    x:Class="RDS_Shadow.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:win="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:helpers="using:RDS_Shadow.Helpers"
    xmlns:xaml="using:Microsoft.UI.Xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:ui="using:CommunityToolkit.WinUI"
    mc:Ignorable="d">
    <Page.Resources>
        <helpers:EnumToBooleanConverter x:Key="EnumToBooleanConverter" />
    </Page.Resources>
    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Padding="12">
            <StackPanel x:Name="ContentArea">
                <TextBlock x:Uid="Settings_Personalization" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="{StaticResource XSmallTopBottomMargin}" />
                <controls:SettingsCard x:Name="settingsThemeCard"
                                       x:Uid="settingsThemeCard"
                               HeaderIcon="{ui:FontIcon Glyph=&#xE790;}">
                    <!-- Theme selection: localized ComboBox items. Tag contains the ElementTheme name. -->
                    <ComboBox x:Name="SettingsThemeComboBox" SelectionChanged="SettingsThemeComboBox_SelectionChanged" MinWidth="280" MinHeight="40">
                        <ComboBoxItem x:Uid="Settings_Theme_Light" Tag="Light" />
                        <ComboBoxItem x:Uid="Settings_Theme_Dark" Tag="Dark" />
                        <ComboBoxItem x:Uid="Settings_Theme_Default" Tag="Default" />
                    </ComboBox>
                </controls:SettingsCard>
                <controls:SettingsCard x:Name="settingsLanguageCard"
                       x:Uid="settingsLanguageCard"
               HeaderIcon="{ui:FontIcon Glyph=&#xf2b7;}">
                    <!-- Language selection in top SettingsCard -->
                    <ComboBox x:Name="SettingsLanguageComboBox" SelectionChanged="SettingsLanguageComboBox_SelectionChanged" MinWidth="280" MinHeight="40">
                        <ComboBoxItem x:Uid="Settings_Language_English" Tag="en-US" />
                        <ComboBoxItem x:Uid="Settings_Language_German" Tag="de-DE" />
                    </ComboBox>
                </controls:SettingsCard>

                <TextBlock x:Uid="Settings_Database" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="{StaticResource XSmallTopBottomMargin}" /> 

                <controls:SettingsCard x:Uid="settingsSQLServerCard"
                       HorizontalContentAlignment="Stretch" >

                    <TextBox x:Name="Settings_SQLServer"
                             Margin="{StaticResource XSmallTopMargin}"
                             HorizontalAlignment="Stretch"
                             VerticalAlignment="Center"
                             MinWidth="280" MinHeight="40"
                             LostFocus="Settings_SQLServer_LostFocus"
                             TextChanged="Settings_SQLServer_TextChanged" />
                </controls:SettingsCard>
               
                <controls:SettingsCard x:Uid="settingsSQLDBCard"
                       HorizontalContentAlignment="Stretch">
                    <StackPanel>
                        <TextBox x:Name="Settings_Databasename"
                                 Margin="{StaticResource XSmallTopMargin}"
                                 HorizontalAlignment="Stretch"
                                 VerticalAlignment="Center"
                                 MinWidth="280" MinHeight="40"
                                 LostFocus="Settings_Databasename_LostFocus"
                                 TextChanged="Settings_Databasename_TextChanged" />
                    </StackPanel>
                </controls:SettingsCard>

                <!-- Section: Manual Terminal Servers -->
                <TextBlock x:Uid="Settings_TSSettings" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="{StaticResource XSmallTopBottomMargin}" />

                <!-- Terminal servers card -->
                <controls:SettingsCard x:Name="settingsTSCard" x:Uid="settingsTSCard"
                                       HorizontalContentAlignment="Stretch">
                    <StackPanel>
                        <TextBox x:Uid="Settings_TSName" x:Name="Settings_TSname" Margin="{StaticResource XSmallTopMargin}" PlaceholderText="Host1,Host2" MinWidth="280" MinHeight="40" LostFocus="Settings_TSname_LostFocus" TextChanged="Settings_TSname_TextChanged" />
                    </StackPanel>
                </controls:SettingsCard>

                <TextBlock x:Name="Settings_OtherSettings" x:Uid="Settings_OtherSettings" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="{StaticResource XSmallTopBottomMargin}" />

                <controls:SettingsCard x:Name="settingsIncludeClientCard" x:Uid="settingsIncludeClientCard"
                       HorizontalContentAlignment="Stretch">

                    <!-- Inhalt rechts: ToggleSwitch replaces the old CheckBox -->
                    <ToggleSwitch x:Name="Settings_IncludeClientToggle" Toggled="Settings_IncludeClientToggle_Toggled"
                                  IsOn="{x:Bind ViewModel.AskForClientName, Mode=TwoWay}"
                                  VerticalAlignment="Center" />
                </controls:SettingsCard>

              

                <TextBlock x:Uid="Settings_About" x:Name="Settings_About" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="{StaticResource XSmallTopBottomMargin}" />
                <controls:SettingsExpander x:Uid="settingsAboutExpander" HeaderIcon="{ui:BitmapIcon Source=ms-appx:///Assets/Square44x44Logo.scale-200.png}">
                    <!-- Version shown in expander content; bind to ViewModel.Version (number only) -->
                    <TextBlock win:IsTextSelectionEnabled="True"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="{x:Bind ViewModel.Version, Mode=OneWay}" />

                    <controls:SettingsExpander.Header>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock x:Name="SettingsAboutHeaderText"
                                       
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </controls:SettingsExpander.Header>
                    <controls:SettingsExpander.Items>
                        <controls:SettingsCard x:Name="settingsCard" x:Uid="Settings_RepoCard" ActionIcon="{ui:FontIcon Glyph=&#xe8c8;}"
                               Click="OnCardClicked"
                               Header="Repository klonen"
                               IsClickEnabled="True">
                            <TextBlock x:Name="Settings_RepoCommand" x:Uid="Settings_RepoCommand"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       Text="git clone https://github.com/stetze/RDS-Shadow.git"
                                       FontFamily="Cascadia Mono"
                                       VerticalAlignment="Center" />
                        </controls:SettingsCard>
                        <controls:SettingsCard HorizontalContentAlignment="Left"
                                               ContentAlignment="Left">
                            <StackPanel Margin="-12,0,0,0"
                                        Orientation="Vertical">
                                <HyperlinkButton x:Uid="SettingsPage_PrivacyTermsLink" x:Name="SettingsPage_PrivacyTermsLink" Margin="{StaticResource SettingsPageHyperlinkButtonMargin}" />
                            </StackPanel>
                        </controls:SettingsCard>
                    </controls:SettingsExpander.Items>
                </controls:SettingsExpander>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
